<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <record id="view_freight_move_form_inherited" model="ir.ui.view">
            <field name="name">account.move.form.inherited</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_move_form"/>
            <field name="arch" type="xml">

                <xpath expr="//div[@name='button_box']" position="inside">
                    <field name="project_task_id" invisible="1"/>
                    <button name="action_open_project_task" type="object" invisible="not project_task_id"
                            class="oe_stat_button" icon="fa-tasks">
                        <field name="project_task_id" widget="statinfo" string="Operation"/>
                    </button>
                </xpath>
                <xpath expr="//form" position="attributes">
                    <attribute name="create">0</attribute>
                    <attribute name="delete">false</attribute>
                </xpath>
                <xpath expr="//field[@name='partner_id']" position="attributes">
                    <attribute name="options">{'no_edit': True, 'no_create': True,'no_open': True}</attribute>
                </xpath>
                <xpath expr="//field[@name='partner_shipping_id']" position="attributes">
                    <attribute name="options">{'no_edit': True, 'no_create': True,'no_open': True}</attribute>
                </xpath>
                <xpath expr="//group[@id='header_right_group']/field[@name='currency_id']" position="attributes">
                    <attribute name="readonly">1</attribute>
                </xpath>
                <xpath expr="//group[@name='accounting_info_group']/field[@name='invoice_incoterm_id']"
                       position="attributes">
                    <attribute name="options">{'no_edit': True, 'no_create': True,'no_open': True}</attribute>
                </xpath>
                <xpath expr="//group[@name='accounting_info_group']/field[@name='fiscal_position_id']"
                       position="attributes">
                    <attribute name="options">{'no_edit': True, 'no_create': True,'no_open': True}</attribute>
                </xpath>
                <xpath expr="//group[@id='header_right_group']" position="replace">
                    <group id="header_right_group">

                        <!-- Invoice date (only invoices / receipts) -->
                        <label for="invoice_date" string="Invoice Date" style="font-weight:bold;"
                               invisible="move_type not in ('out_invoice', 'out_refund', 'out_receipt')"/>
                        <label for="invoice_date" string="Bill Date" style="font-weight:bold;"
                               invisible="move_type not in ('in_invoice', 'in_refund', 'in_receipt')"/>
                        <field name="invoice_date" nolabel="1" options="{'warn_future': true}"
                               invisible="move_type not in ('out_invoice', 'out_refund', 'in_invoice', 'in_refund', 'out_receipt', 'in_receipt')"
                               readonly="state != 'draft'"/>

                        <field name="date" string="Accounting Date"
                               invisible="move_type in ('out_invoice', 'out_refund', 'out_receipt') and not quick_edit_mode and not (state == 'posted' and date != invoice_date)"
                               readonly="state != 'draft'"/>

                    </group>
                </xpath>
                <xpath expr="//group[@id='header_right_group']" position="after">
                    <group string="Invoice Details" invisible="move_type == 'in_invoice' or not is_freight">
                        <field name="transport_type_id" readonly="1"/>
                        <field name="master_bl" readonly="1"/>
                        <field name="pol" string="POL" readonly="1"/>
                        <field name="pod" string="POD" readonly="1"/>
                        <field name="is_freight" invisible="1"/>
                        <field name="show_packages" invisible="1"/>
                        <field name="show_containers" invisible="1"/>
                    </group>
                    <group string="Bill Details" invisible="move_type == 'out_invoice' or not is_freight">
                        <field name="transport_type_id" readonly="1"/>
                        <field name="master_bl" readonly="1"/>
                        <field name="pol" string="POL" readonly="1"/>
                        <field name="pod" string="POD" readonly="1"/>
                        <field name="is_freight" invisible="1"/>
                        <field name="show_packages" invisible="1"/>
                        <field name="show_containers" invisible="1"/>
                    </group>
                    <group invisible="is_freight"/>
                    <group>
                        <field name="payment_reference"
                               invisible="move_type not in ('out_invoice', 'out_refund', 'in_invoice', 'in_refund', 'out_receipt', 'in_receipt')"
                               readonly="inalterable_hash != False"/>
                        <field name="partner_bank_id"
                               context="{'default_partner_id': bank_partner_id, 'display_account_trust': True}"
                               domain="[('partner_id', '=', bank_partner_id)]"
                               invisible="move_type not in ('in_invoice', 'in_refund', 'in_receipt')"
                               readonly="state != 'draft'"/>
                        <!-- Invoice payment terms (only invoices) + due date (only invoices / receipts) -->
                        <div class="o_td_label"
                             invisible="move_type not in ('out_invoice', 'out_refund', 'in_invoice', 'in_refund', 'out_receipt', 'in_receipt')">
                            <label for="invoice_date_due" string="Due Date"
                                   invisible="invoice_payment_term_id"/>
                            <label for="invoice_payment_term_id" string="Payment terms"
                                   invisible="not invoice_payment_term_id"/>
                        </div>
                        <div class="d-flex"
                             invisible="move_type not in ('out_invoice', 'out_refund', 'in_invoice', 'in_refund', 'out_receipt', 'in_receipt')"
                             name="due_date">
                            <field name="invoice_date_due" force_save="1"
                                   placeholder="Date"
                                   invisible="invoice_payment_term_id"/>
                            <span class="o_form_label mx-3 oe_edit_only"
                                  invisible="state != 'draft' or invoice_payment_term_id">or
                            </span>
                            <field name="invoice_payment_term_id"
                                   context="{'example_date': invoice_date, 'example_amount': tax_totals['amount_total']}"
                                   placeholder="Payment Terms"
                                   options="{'no_quick_create':True}" readonly="state in ['cancel', 'posted']"/>
                        </div>
                        <field name="delivery_date" invisible="not show_delivery_date" readonly="state != 'draft'"/>
                        <label for="journal_id"
                               groups="account.group_account_readonly"
                               invisible="context.get('default_journal_id') and context.get('move_type', 'entry') != 'entry'"/>
                        <div name="journal_div"
                             class="d-flex"
                             groups="account.group_account_readonly"
                             invisible="context.get('default_journal_id') and context.get('move_type', 'entry') != 'entry'">
                            <field name="journal_id"
                                   options="{'no_create': True, 'no_open': True}"
                                   readonly="posted_before"/>
                            <span class="oe_inline o_form_label mx-3"
                                  groups="base.group_multi_currency"
                                  invisible="move_type == 'entry'">in
                            </span>
                            <field name="currency_id"
                                   groups="base.group_multi_currency"
                                   invisible="move_type == 'entry'"
                                   readonly="state != 'draft'"
                                   options="{'no_create': True}"
                                   context="{'search_default_active': 1, 'search_default_inactive': 1}"/>
                        </div>

                        <field name="currency_id"
                               readonly="state != 'draft'"
                               groups="!account.group_account_readonly,base.group_multi_currency"
                               options="{'no_create': True}"/>
                        <field name="invoice_nature"/>
                    </group>
                </xpath>
                <xpath expr="//group[@name='accounting_info_group']" position="inside">
                    <field name="is_freight" readonly="1"/>
                </xpath>
                <xpath expr="//field[@name='invoice_line_ids']/tree/field[@name='product_id']" position="replace">
                    <field name="product_id" string="Charge Type" column_invisible="not parent.is_freight"/>
                    <field name="product_id" string="Product" column_invisible="parent.is_freight"/>
                </xpath>
                <xpath expr="//field[@name='invoice_line_ids']/tree/field[@name='name']" position="replace">
                    <field name="package_type_id"
                           column_invisible="not parent.show_packages"
                           options="{'no_edit': True, 'no_create': True,'no_open': True}"
                           optional="hide"/>
                    <field name="container_type_id"
                           column_invisible="not parent.show_containers"
                           options="{'no_edit': True, 'no_create': True,'no_open': True}"
                           optional="hide"/>
                </xpath>
            </field>
        </record>
        <record id="view_account_move_filter_inherit" model="ir.ui.view">
            <field name="name">account.move.select.inherit</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_account_move_filter"/>
            <field name="arch" type="xml">
                <xpath expr="//search" position="inside">
                    <filter string="Taxable" name="invoice_nature" domain="[('invoice_nature', '=', 'taxable')]"/>
                    <filter string="Non-Taxable" name="invoice_nature"
                            domain="[('invoice_nature', '=', 'nontaxable')]"/>
                    <separator/>
                    <filter name="archived" string="Canceled" domain="[('active', '=', False)]"/>
                    <separator/>
                </xpath>
                <xpath expr="//group" position="inside">
                    <filter string="Invoice Nature" name="by_invoice_nature" domain="[]"
                            context="{'group_by': 'invoice_nature'}"/>
                </xpath>
            </field>
        </record>


        <record id="view_freight_invoice_tree" model="ir.ui.view">
            <field name="name">account.invoice.freight.tree</field>
            <field name="model">account.move</field>
            <field name="arch" type="xml">
                <tree string="Invoices" create="0" delete="0"
                      decoration-info="state == 'draft'"
                      decoration-muted="state == 'cancel'">
                    <field name="made_sequence_hole" column_invisible="True"/>
                    <field name="name" decoration-bf="1" decoration-danger="made_sequence_hole"/>
                    <field name="invoice_partner_display_name"
                           column_invisible="context.get('default_move_type') not in ('in_invoice', 'in_refund', 'in_receipt')"
                           groups="base.group_user" string="Vendor"/>
                    <field name="invoice_partner_display_name"
                           column_invisible="context.get('default_move_type') not in ('out_invoice', 'out_refund', 'out_receipt')"
                           groups="base.group_user" string="Customer"/>
                    <field name="invoice_date" optional="show"
                           column_invisible="context.get('default_move_type') not in ('in_invoice', 'in_refund', 'in_receipt')"
                           readonly="state != 'draft'" string="Bill Date"/>
                    <field name="invoice_date" optional="show"
                           column_invisible="context.get('default_move_type') not in ('out_invoice', 'out_refund', 'out_receipt')"
                           readonly="state != 'draft'" string="Invoice Date"/>
                    <field name="date" optional="hide" string="Accounting Date"
                           readonly="state in ['cancel', 'posted']"/>
                    <field name="invoice_date_due" widget="remaining_days" optional="show"
                           invisible="payment_state in ('paid', 'in_payment', 'reversed') or state == 'cancel'"/>
                    <field name="invoice_origin" optional="hide" string="Source Document"/>
                    <field name="payment_reference" optional="hide"
                           column_invisible="context.get('default_move_type') in ('out_invoice', 'out_refund', 'out_receipt')"/>
                    <field name="ref" optional="hide"/>
                    <field name="invoice_user_id" optional="hide"
                           column_invisible="context.get('default_move_type') not in ('out_invoice', 'out_refund', 'out_receipt')"
                           string="Salesperson" widget="many2one_avatar_user"/>
                    <field name="activity_ids" widget="list_activity" optional="show"/>
                    <field name="company_id" groups="base.group_multi_company" options="{'no_create': True}"
                           optional="hide"/>
                    <field name="company_id" groups="!base.group_multi_company" column_invisible="True"/>
                    <field name="amount_untaxed_signed" string="Tax Excluded" sum="Total" optional="show"/>
                    <field name="amount_tax_signed" string="Tax" sum="Total" optional="hide"/>
                    <field name="amount_total_signed" string="Total" sum="Total" decoration-bf="1" optional="show"/>
                    <field name="amount_total_in_currency_signed" string="Total in Currency" optional="show"
                           groups="base.group_multi_currency"/>
                    <field name="amount_total_in_currency_signed" string="Total in Currency" optional="hide"
                           groups="!base.group_multi_currency"/>
                    <field name="amount_residual_signed" string="Amount Due" sum="Amount Due" optional="hide"/>
                    <field name="currency_id" optional="hide" readonly="state in ['cancel', 'posted']"/>
                    <field name="company_currency_id" column_invisible="True"/>
                    <field name="is_freight" column_invisible="True"/>
                    <field name="to_check" optional="hide" widget="boolean_toggle"/>
                    <field name="payment_state"
                           string="Payment"
                           widget="badge"
                           decoration-danger="payment_state == 'not_paid'"
                           decoration-warning="payment_state in ('partial', 'in_payment')"
                           decoration-success="payment_state in ('paid', 'reversed')"
                           invisible="payment_state == 'invoicing_legacy' or state != 'posted' or move_type == 'entry'"
                           optional="show"/>
                    <field name="state" widget="badge" decoration-success="state == 'posted'"
                           decoration-info="state == 'draft'" optional="show"/>
                    <field name="move_type" column_invisible="context.get('default_move_type', True)"/>
                </tree>
            </field>
        </record>

        <record id="action_freight_move_out_invoice_type" model="ir.actions.act_window">
            <field name="name">Freight Invoices</field>
            <field name="res_model">account.move</field>
            <field name="view_mode">tree,kanban,form,activity</field>
            <field name="search_view_id" ref="view_account_move_filter_inherit"/>
            <field name="view_ids" eval="[(5, 0, 0),
                (0, 0, {'view_mode': 'tree', 'view_id': ref('view_freight_invoice_tree')}),
                (0, 0, {'view_mode': 'form', 'view_id': ref('view_freight_move_form_inherited')}),
            ]"/>
            <field name="domain">[('move_type', '=', 'out_invoice'), ('is_freight', '=', True)]
            </field>
            <field name="context">{'default_move_type': 'out_invoice', 'default_is_freight': True}</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Create a customer invoice
                </p>
                <p>
                    Create invoices, register payments and keep track of the discussions with your customers.
                </p>
            </field>
        </record>

        <record id="action_freight_move_in_invoice_type" model="ir.actions.act_window">
            <field name="name">Freight Bills</field>
            <field name="res_model">account.move</field>
            <field name="view_mode">tree,kanban,form,activity</field>
            <field name="search_view_id" ref="view_account_move_filter_inherit"/>
            <field name="view_ids" eval="[(5, 0, 0),
                (0, 0, {'view_mode': 'tree', 'view_id': ref('view_freight_invoice_tree')}),
                (0, 0, {'view_mode': 'form', 'view_id': ref('view_freight_move_form_inherited')}),
            ]"/>
            <field name="domain">[('move_type', '=', 'in_invoice'), ('is_freight', '=', True)]
            </field>
            <field name="context">{'default_move_type': 'in_invoice', 'default_is_freight': True,
                'display_account_trust': True}
            </field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Create a vendor bill
                </p>
                <p>
                    Create vendor bills, register payments and keep track of the discussions with your vendors.
                </p>
            </field>
        </record>


        <record id="account.action_move_journal_line" model="ir.actions.act_window">
            <field name="search_view_id" ref="view_account_move_filter_inherit"/>
        </record>

        <record id="account.action_move_out_invoice_type" model="ir.actions.act_window">
            <field name="search_view_id" ref="view_account_move_filter_inherit"/>
            <field name="domain">[('move_type', '=', 'out_invoice')]</field>
        </record>
        <record id="account.action_move_in_invoice_type" model="ir.actions.act_window">
            <field name="search_view_id" ref="view_account_move_filter_inherit"/>
            <field name="domain">[('move_type', '=', 'in_invoice')]</field>
        </record>
        <record id="view_move_form_inherit_purchase_update" model="ir.ui.view">
            <field name="name">account.move.inherit.purchase.update</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_move_form"/>
            <field name="arch" type="xml">
                <!-- Make the purchase_vendor_bill_id field invisible -->
                <xpath expr="//field[@name='purchase_vendor_bill_id']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>

                <!-- Make the label for purchase_vendor_bill_id invisible -->
                <xpath expr="//label[@for='purchase_vendor_bill_id']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
            </field>
        </record>

    </data>
</odoo>